{
	"jobConfig": {
		"name": "MindEase_Suoni",
		"description": "",
		"role": "arn:aws:iam::211125505563:role/LabRole",
		"command": "glueetl",
		"version": "4.0",
		"runtime": null,
		"workerType": "G.2X",
		"numberOfWorkers": 10,
		"maxCapacity": 20,
		"maxRetries": 0,
		"timeout": 2880,
		"maxConcurrentRuns": 1,
		"security": "none",
		"scriptName": "MindEase_Suoni.py",
		"scriptLocation": "s3://mindease-script/",
		"language": "python-3",
		"spark": true,
		"sparkConfiguration": "standard",
		"jobParameters": [],
		"tags": [],
		"jobMode": "DEVELOPER_MODE",
		"createdOn": "2024-07-06T16:39:26.732Z",
		"developerMode": true,
		"connectionsList": [],
		"temporaryDirectory": "s3://aws-glue-assets-211125505563-us-east-1/temporary/",
		"logging": true,
		"glueHiveMetastore": true,
		"etlAutoTuning": false,
		"metrics": true,
		"observabilityMetrics": true,
		"bookmark": "job-bookmark-disable",
		"sparkPath": "s3://mindease-logs/",
		"flexExecution": false,
		"minFlexWorkers": null,
		"maintenanceWindow": null
	},
	"hasBeenSaved": false,
	"usageProfileName": null,
	"script": "###### TEDx-Load-Aggregate-Model\r\n######\r\n\r\nimport sys\r\nimport json\r\nimport pyspark\r\nfrom pyspark.sql.functions import col, collect_list, array_join,array_intersect,size,array,lit\r\n\r\nfrom awsglue.transforms import *\r\nfrom awsglue.utils import getResolvedOptions\r\nfrom pyspark.context import SparkContext\r\nfrom awsglue.context import GlueContext\r\nfrom awsglue.job import Job\r\n\r\nfrom pyspark.sql.functions import array_contains\r\nfrom functools import reduce\r\n\r\n\r\n##### FROM FILES\r\ntedx_dataset_path = \"s3://mindease-data/suoni.csv\"\r\n\r\n###### READ PARAMETERS\r\nargs = getResolvedOptions(sys.argv, ['JOB_NAME'])\r\n\r\n##### START JOB CONTEXT AND JOB\r\nsc = SparkContext()\r\n\r\n\r\nglueContext = GlueContext(sc)\r\nspark = glueContext.spark_session\r\n\r\n\r\n    \r\njob = Job(glueContext)\r\njob.init(args['JOB_NAME'], args)\r\n\r\n\r\n#### READ INPUT FILES TO CREATE AN INPUT DATASET\r\ntedx_dataset = spark.read \\\r\n    .option(\"header\",\"true\") \\\r\n    .option(\"quote\", \"\\\"\") \\\r\n    .option(\"escape\", \"\\\"\") \\\r\n    .csv(tedx_dataset_path)\r\n\r\ntedx_dataset.printSchema()\r\n\r\n\r\n\r\n\r\nwrite_mongo_options = {\r\n    \"connectionName\": \"MindEase\",\r\n    \"database\": \"Tesi_MindEase\",\r\n    \"collection\": \"MindEase_suoni\",\r\n    \"ssl\": \"true\",\r\n    \"ssl.domain_match\": \"false\"}\r\nfrom awsglue.dynamicframe import DynamicFrame\r\ntedx_dataset_dynamic_frame = DynamicFrame.fromDF(tedx_dataset, glueContext, \"nested\")\r\n\r\nglueContext.write_dynamic_frame.from_options(tedx_dataset_dynamic_frame, connection_type=\"mongodb\", connection_options=write_mongo_options)\r\n"
}